load_all()
p <- SummarizeViralStats(file=file,groupby = "best_query",metric = "ViralRefSeq_ident",metric_cutoff = 90,show_total = TRUE,filter_cutoff = 1e-5,extra_stats = c("median","Q1","Q3"))
View(p)
p <- SummarizeViralStats(file=file,groupby = "best_query",metric = "ViralRefSeq_ident",metric_cutoff = 90,show_total = TRUE,filter_cutoff = 1e-5,extra_stats = c("median","Q1"))
View(p)
document()
check()
load_all()
?SummarizeViralStats
path <- system.file("extdata", "virushunter.tsv", package = "Virusparies")
file <- ImportVirusTable(path)
stats <- SummarizeViralStats(file=file,
groupby = "best_query",
metric = "ViralRefSeq_ident",
metric_cutoff = 90,
show_total = TRUE,
filter_cutoff = 1e-5,
extra_stats = c("median","Q1","Q3"))
print(stats)
path <- system.file("extdata", "virushunter.tsv", package = "Virusparies")
file <- ImportVirusTable(path)
stats <- SummarizeViralStats(file=file,
groupby = "best_query",
metric = "ViralRefSeq_ident",
metric_cutoff = 90,
show_total = TRUE,
filter_cutoff = 1e-5,
extra_stats = c("median","Q1","Q3","median","sd"))
print(stats)
document()
check()
?VhgIdenFacetedScatterPlot
# import gatherer files
path2 <- system.file("extdata", "virusgatherer.tsv", package = "Virusparies")
vg_file <- ImportVirusTable(path2)
# vgplot: virusgatherer plot with ViralRefSeq_taxonomy as custom grouping
vgplot <- VhgIdenFacetedScatterPlot(vg_file,groupby = "ViralRefSeq_taxonomy")
vgplot
# import gatherer files
path2 <- system.file("extdata", "virusgatherer.tsv", package = "Virusparies")
vg_file <- ImportVirusTable(path2)
# vgplot: virusgatherer plot with ViralRefSeq_taxonomy as custom grouping
vgplot <- VhgIdenFacetedScatterPlot(vg_file,groupby = "ViralRefSeq_taxonomy",subtitle = "test")
vgplot
?VhgRunsBarplot
# import data
path <- system.file("extdata", "virushunter.tsv", package = "Virusparies")
file <- ImportVirusTable(path)
# plot 1: plot boxplot for "identity"
plot <- VhgRunsBarplot(file,cut = 1e-5)
plot
# import data
path <- system.file("extdata", "virushunter.tsv", package = "Virusparies")
file <- ImportVirusTable(path)
# plot 1: plot boxplot for "identity"
plot <- VhgRunsBarplot(file,cut = 1e-5,subtitle = NULL)
load_all()
# import data
path <- system.file("extdata", "virushunter.tsv", package = "Virusparies")
file <- ImportVirusTable(path)
# plot 1: plot boxplot for "identity"
plot <- VhgRunsBarplot(file,cut = 1e-5,subtitle = NULL)
plot
?VhgBoxplot
# plot 1 for e-values
plot1 <- VhgBoxplot(file, x_column = "best_query", y_column = "ViralRefSeq_E",subtitle = NULL)
# plot 1 for e-values
plot1 <- VhgBoxplot(file, x_column = "best_query", y_column = "ViralRefSeq_E",title = NULL)
load_all()
# plot 1 for e-values
plot1 <- VhgBoxplot(file, x_column = "best_query", y_column = "ViralRefSeq_E",title = NULL)
plot1
# plot 1 for e-values
plot1 <- VhgBoxplot(file, x_column = "best_query", y_column = "ViralRefSeq_E",subtitle = NULL)
plot1
?VhSumHitsBarplot
# plot 1: plot boxplot for "identity"
plot <- VhSumHitsBarplot(vh_file,cut = 1e-5)
path <- system.file("extdata", "virushunter.tsv", package = "Virusparies")
vh_file <- ImportVirusTable(path)
# plot 1: plot boxplot for "identity"
plot <- VhSumHitsBarplot(vh_file,cut = 1e-5)
plot
path <- system.file("extdata", "virushunter.tsv", package = "Virusparies")
vh_file <- ImportVirusTable(path)
# plot 1: plot boxplot for "identity"
plot <- VhSumHitsBarplot(vh_file,cut = 1e-5,title = NULL)
plot
path <- system.file("extdata", "virushunter.tsv", package = "Virusparies")
vh_file <- ImportVirusTable(path)
# plot 1: plot boxplot for "identity"
plot <- VhSumHitsBarplot(vh_file,cut = 1e-5,subtitle = NULL)
load_all()
path <- system.file("extdata", "virushunter.tsv", package = "Virusparies")
vh_file <- ImportVirusTable(path)
# plot 1: plot boxplot for "identity"
plot <- VhSumHitsBarplot(vh_file,cut = 1e-5,subtitle = NULL)
plot
all_names <- names(file)
if (!("SRA_run" %in% all_names) && !("run_id" %in% all_names)) {
stop("Neither 'SRA_run' nor 'run_id' found in file. Available column names: ", paste(all_names, collapse = ", "))
}
n_distinct(coalesce(file$SRA_run, file$run_id))
c("SRA_run", "run_id")[c("SRA_run", "run_id") %in% names(file)]
available_columns <- c("SRA_run", "run_id")[c("SRA_run", "run_id") %in% names(file)]
available_columns
available_columns[1]]
available_columns[1]
available_columns[[1]]
load_all()
?VhgRunsBarplot
# import data
path <- system.file("extdata", "virushunter.tsv", package = "Virusparies")
file <- ImportVirusTable(path)
# plot 1: plot boxplot for "identity"
plot <- VhgRunsBarplot(file,cut = 1e-5)
plot
load_all()
# import data
path <- system.file("extdata", "virushunter.tsv", package = "Virusparies")
file <- ImportVirusTable(path)
# plot 1: plot boxplot for "identity"
plot <- VhgRunsBarplot(file,cut = 1e-5)
plot
load_all()
# import data
path <- system.file("extdata", "virushunter.tsv", package = "Virusparies")
file <- ImportVirusTable(path)
# plot 1: plot boxplot for "identity"
plot <- VhgRunsBarplot(file,cut = 1e-5)
plot
document()
check()
# import data
path <- system.file("extdata", "virushunter.tsv", package = "Virusparies")
file <- ImportVirusTable(path)
# plot 1: plot boxplot for "identity"
plot <- VhgRunsBarplot(file,cut = 1e-5)
plot
is.data.frame(file)
?VhgBoxplot
path <- system.file("extdata", "virushunter.tsv", package = "Virusparies")
file <- ImportVirusTable(path)
# plot 1 for e-values
plot1 <- VhgBoxplot(file, x_column = "best_query", y_column = "ViralRefSeq_E")
plot1
is.data.frame(plot1$rows_belowthres)
colnames(plot1$rows_belowthres)
nrow(file)
document()
check()
document()
check()
load_all()
?CombineHittables
path <- system.file("extdata", "virushunter.tsv", package = "Virusparies")
file <- ImportVirusTable(path)
file2 <- ImportVirusTable(path)  # both files have 180 observations
combined_file <- CombineHittables(file,file2)
print(nrow(combined_file))
View(combined_file)
?`Virusparies-package`
library(devtools)
document()
load_all()
?SummarizeViralStats
path <- system.file("extdata", "virushunter.tsv", package = "Virusparies")
file <- ImportVirusTable(path)
stats <- SummarizeViralStats(file=file,
groupby = "best_query",
metric = "ViralRefSeq_ident",
metric_cutoff = 90,
show_total = TRUE,
filter_cutoff = 1e-5,
extra_stats = c("median","Q1","Q3"))
stats
stats <- SummarizeViralStats(file=file,
groupby = "best_query",
metric = "ViralRefSeq_ident",
metric_cutoff = 90,
show_total = TRUE,
filter_cutoff = 1e-5,
extra_stats = c("median","Q1","Q3"),sort_by = "equal_or_more_than_90")
stats
stats <- SummarizeViralStats(file=file,
groupby = "best_query",
metric = "ViralRefSeq_ident",
metric_cutoff = 90,
show_total = TRUE,
filter_cutoff = 1e-5,
extra_stats = c("median","Q1","Q3"),sort_by = "less_than_90")
stats
stats <- SummarizeViralStats(file=file,
groupby = "best_query",
metric = "ViralRefSeq_ident",
metric_cutoff = 90,
show_total = TRUE,
filter_cutoff = 1e-5,
extra_stats = c("median","Q1","Q3"),sort_by = "median")
stats
stats <- SummarizeViralStats(file=file,
groupby = "best_query",
metric = "ViralRefSeq_ident",
metric_cutoff = 90,
show_total = TRUE,
filter_cutoff = 1e-5,
extra_stats = c("median","Q1","Q3"),sort_by = "less_than_x")
stats <- SummarizeViralStats(file=file,
groupby = "best_query",
metric = "ViralRefSeq_ident",
metric_cutoff = 90,
show_total = TRUE,
filter_cutoff = 1e-5,
extra_stats = c("median","Q1","Q3"),sort_by = "less_than_90")
stats
stats <- SummarizeViralStats(file=file,
groupby = "best_query",
metric = "ViralRefSeq_ident",
metric_cutoff = 90,
show_total = TRUE,
filter_cutoff = 1e-5,
extra_stats = c("median","Q1","Q3"),sort_by = "Q1")
stats
stats <- SummarizeViralStats(file=file,
groupby = "best_query",
metric = "ViralRefSeq_ident",
metric_cutoff = 90,
show_total = TRUE,
filter_cutoff = 1e-5,
extra_stats = c("median","Q1","Q3"),sort_by = "Q3")
stats
stats <- SummarizeViralStats(file=file,
groupby = "best_query",
metric = "ViralRefSeq_ident",
metric_cutoff = 90,
show_total = TRUE,
filter_cutoff = 1e-5,
extra_stats = c("median","Q1","Q3"),sort_by = "total")
stats
SummarizeViralStats(
file = file,
groupby = "best_query",
metric = "ViralRefSeq_ident",
metric_cutoff = 90,
show_total = TRUE,
filter_cutoff = 1e-5,
extra_stats = c("median", "Q1", "Q3"),
sort_by = "total"  # or "less_than_90", "equal_or_more_than_90"
)
load_all()
SummarizeViralStats(
file = file,
groupby = "best_query",
metric = "ViralRefSeq_ident",
metric_cutoff = 90,
show_total = TRUE,
filter_cutoff = 1e-5,
extra_stats = c("median", "Q1", "Q3"),
sort_by = "total"  # or "less_than_90", "equal_or_more_than_90"
)
SummarizeViralStats(
file = file,
groupby = "best_query",
metric = "ViralRefSeq_ident",
metric_cutoff = 90,
show_total = TRUE,
filter_cutoff = 1e-5,
extra_stats = c("median", "Q1", "Q3"),
sort_by = "equal_or_more_than_90"  # or "less_than_90", "equal_or_more_than_90"
)
SummarizeViralStats(
file = file,
groupby = "best_query",
metric = "ViralRefSeq_ident",
metric_cutoff = 90,
show_total = TRUE,
filter_cutoff = 1e-5,
extra_stats = c("median", "Q1", "Q3"),
sort_by = "less_than_90"  # or "less_than_90", "equal_or_more_than_90"
)
SummarizeViralStats(
file = file,
groupby = "best_query",
metric = "ViralRefSeq_ident",
metric_cutoff = 90,
show_total = TRUE,
filter_cutoff = 1e-5,
extra_stats = c("median", "Q1", "Q3"),
sort_by = "median"  # or "less_than_90", "equal_or_more_than_90"
)
SummarizeViralStats(
file = file,
groupby = "best_query",
metric = "ViralRefSeq_ident",
metric_cutoff = 90,
show_total = TRUE,
filter_cutoff = 1e-5,
extra_stats = c("median", "Q1", "Q3"),
sort_by = "median",top_n = 2
)
SummarizeViralStats(
file = file,
groupby = "best_query",
metric = "ViralRefSeq_ident",
metric_cutoff = 90,
show_total = TRUE,
filter_cutoff = 1e-5,
extra_stats = c("median", "Q1", "Q3"),top_n = 2
)
SummarizeViralStats(
file = file,
groupby = "best_query",
metric = "ViralRefSeq_ident",
metric_cutoff = 90,
show_total = TRUE,
filter_cutoff = 1e-5,
extra_stats = c("median", "Q1", "Q3")
)
check()
library(Virusparies)
?VhgBoxplot
path <- system.file("extdata", "virushunter.tsv", package = "Virusparies")
file <- ImportVirusTable(path)
# plot 1 for e-values
plot1 <- VhgBoxplot(file, x_column = "best_query", y_column = "ViralRefSeq_E")
plot1
path <- system.file("extdata", "virushunter.tsv", package = "Virusparies")
file <- ImportVirusTable(path)
# plot 1 for e-values
plot1 <- VhgBoxplot(file, x_column = "best_query", y_column = "ViralRefSeq_E",flip_coords = FALSE)
plot1
path <- system.file("extdata", "virushunter.tsv", package = "Virusparies")
file <- ImportVirusTable(path)
# plot 1 for e-values
plot1 <- VhgBoxplot(file, x_column = "best_query", y_column = "ViralRefSeq_E",flip_coords = FALSE)
plot1+ theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
path <- system.file("extdata", "virushunter.tsv", package = "Virusparies")
file <- ImportVirusTable(path)
# plot 1 for e-values
plot1 <- VhgBoxplot(file, x_column = "best_query", y_column = "ViralRefSeq_E",flip_coords = FALSE)
plot1$boxp+ theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
library(ggplot2)
path <- system.file("extdata", "virushunter.tsv", package = "Virusparies")
file <- ImportVirusTable(path)
# plot 1 for e-values
plot1 <- VhgBoxplot(file, x_column = "best_query", y_column = "ViralRefSeq_E",flip_coords = FALSE)
plot1$boxp+ theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
# import gatherer files
path2 <- system.file("extdata", "virusgatherer.tsv", package = "Virusparies")
vg_file <- ImportVirusTable(path2)
# plot 4: Virusgatherer plot for ViralRefSeq_taxonomy agains contig length
plot5 <- VhgBoxplot(vg_file,x_column = "ViralRefSeq_taxonomy",y_column = "contig_len")
plot5
# import gatherer files
path2 <- system.file("extdata", "virusgatherer.tsv", package = "Virusparies")
vg_file <- ImportVirusTable(path2)
# plot 4: Virusgatherer plot for ViralRefSeq_taxonomy agains contig length
plot5 <- VhgBoxplot(vg_file,x_column = "ViralRefSeq_taxonomy",y_column = "contig_len",flip_coords = FALSE)
plot5
plot5$boxp+ theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
plot5$boxp+ theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust=1))
path <- system.file("extdata", "virushunter.tsv", package = "Virusparies")
file <- ImportVirusTable(path)
# plot 1 for e-values
plot1 <- VhgBoxplot(file, x_column = "best_query", y_column = "ViralRefSeq_E",flip_coords = TRUE)
plot1$boxp+ theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
# import gatherer files
path2 <- system.file("extdata", "virusgatherer.tsv", package = "Virusparies")
vg_file <- ImportVirusTable(path2)
# plot 4: Virusgatherer plot for ViralRefSeq_taxonomy agains contig length
plot5 <- VhgBoxplot(vg_file,x_column = "ViralRefSeq_taxonomy",y_column = "contig_len",flip_coords = TRUE)
plot5
plot5$boxp+ theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust=1))
plot5$boxp+ theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
plot5$boxp+ theme(axis.text.x = element_text(angle = 45, vjust = 0.5, hjust=1))
plot5$boxp+ theme(axis.text.y  = element_text(angle = 45, vjust = 0.5, hjust=1))
adjust_plot_angles <- function(plot, x_angle = NULL, y_angle = NULL) {
# Check if x_angle is provided, and if so, adjust the x-axis text angle
if (!is.null(x_angle)) {
plot <- plot + theme(axis.text.x = element_text(angle = x_angle, vjust = 0.5, hjust = 1))
}
# Check if y_angle is provided, and if so, adjust the y-axis text angle
if (!is.null(y_angle)) {
plot <- plot + theme(axis.text.y = element_text(angle = y_angle, vjust = 0.5, hjust = 1))
}
# Return the modified plot
return(plot)
}
adjust_plot_angles(plot5$boxp, x_angle = 45, y_angle = 45)
adjust_plot_angles(plot5$boxp, x_angle = 45)
adjust_plot_angles(plot5$boxp, y_angle = 45)
adjust_plot_angles(plot5$boxp)
adjust_plot_angles(plot5$boxp,x_angle = NULL,y_angle = NULL)
library(devtools)
document()
document()
load_all()
?VhSumHitsBarplot
path <- system.file("extdata", "virushunter.tsv", package = "Virusparies")
vh_file <- ImportVirusTable(path)
# plot 1: plot boxplot for "identity"
plot <- VhSumHitsBarplot(vh_file,cut = 1e-5)
plot
path <- system.file("extdata", "virushunter.tsv", package = "Virusparies")
vh_file <- ImportVirusTable(path)
# plot 1: plot boxplot for "identity"
plot <- VhSumHitsBarplot(vh_file,cut = 1e-5,facet_ncol = 2)
plot
path <- system.file("extdata", "virushunter.tsv", package = "Virusparies")
vh_file <- ImportVirusTable(path)
# plot 1: plot boxplot for "identity"
plot <- VhSumHitsBarplot(vh_file,cut = 1e-5,facet_ncol = 2,x_angle = 34)
plot
path <- system.file("extdata", "virushunter.tsv", package = "Virusparies")
vh_file <- ImportVirusTable(path)
# plot 1: plot boxplot for "identity"
plot <- VhSumHitsBarplot(vh_file,cut = 1e-5,facet_ncol = 2,x_angle = 45)
plot
path <- system.file("extdata", "virushunter.tsv", package = "Virusparies")
vh_file <- ImportVirusTable(path)
# plot 1: plot boxplot for "identity"
plot <- VhSumHitsBarplot(vh_file,cut = 1e-5,facet_ncol = 2,x_angle = 90)
plot
path <- system.file("extdata", "virushunter.tsv", package = "Virusparies")
vh_file <- ImportVirusTable(path)
# plot 1: plot boxplot for "identity"
plot <- VhSumHitsBarplot(vh_file,cut = 1e-5,facet_ncol = 2,x_angle = 90,y_angle = 90)
plot
path <- system.file("extdata", "virushunter.tsv", package = "Virusparies")
vh_file <- ImportVirusTable(path)
# plot 1: plot boxplot for "identity"
plot <- VhSumHitsBarplot(vh_file,cut = 1e-5,x_angle = 90,y_angle = 90)
plot
path <- system.file("extdata", "virushunter.tsv", package = "Virusparies")
vh_file <- ImportVirusTable(path)
# plot 1: plot boxplot for "identity"
plot <- VhSumHitsBarplot(vh_file,cut = 1e-5,x_angle = 90)
plot
load_all()
path <- system.file("extdata", "virushunter.tsv", package = "Virusparies")
vh_file <- ImportVirusTable(path)
# plot 1: plot boxplot for "identity"
plot <- VhSumHitsBarplot(vh_file,cut = 1e-5,x_angle = 90)
plot
path <- system.file("extdata", "virushunter.tsv", package = "Virusparies")
vh_file <- ImportVirusTable(path)
# plot 1: plot boxplot for "identity"
plot <- VhSumHitsBarplot(vh_file,cut = 1e-5,x_angle = 90,y_angle = 90)
plot
path <- system.file("extdata", "virushunter.tsv", package = "Virusparies")
vh_file <- ImportVirusTable(path)
# plot 1: plot boxplot for "identity"
plot <- VhSumHitsBarplot(vh_file,cut = 1e-5,facet_ncol = 2,x_angle = 90,y_angle = 90)
plot
path <- system.file("extdata", "virushunter.tsv", package = "Virusparies")
vh_file <- ImportVirusTable(path)
# plot 1: plot boxplot for "identity"
plot <- VhSumHitsBarplot(vh_file,cut = 1e-5,facet_ncol = 2,x_angle = 90,)
plot
check()
document()
document()
check()
?Virusparies
document()
load_all()
# import gatherer files
path2 <- system.file("extdata", "virusgatherer.tsv", package = "Virusparies")
vg_file <- ImportVirusTable(path2)
# create a violinplot.
violinplot <- VgConLenViolin(vg_file=vg_file,cut = 1e-5,log10_scale = TRUE,x_angle = 45)
violinplot
# import gatherer files
path2 <- system.file("extdata", "virusgatherer.tsv", package = "Virusparies")
vg_file <- ImportVirusTable(path2)
# create a violinplot.
violinplot <- VgConLenViolin(vg_file=vg_file,cut = 1e-5,log10_scale = TRUE,y_angle = 45)
violinplot
?VhgRunsBarplot
path <- system.file("extdata", "virushunter.tsv", package = "Virusparies")
file <- ImportVirusTable(path)
# plot 1: plot boxplot for "identity"
plot <- VhgRunsBarplot(file,cut = 1e-5,y_angle = 45)
plot
check()
library(devtools)
document()
check()
library(devtools)
load_all()
VhgAddPhylum()
?VhgAddPhylum()
path <- system.file("extdata", "virushunter.tsv", package = "Virusparies")
vh_file <- ImportVirusTable(path)
vh_file_filtered <- VhgPreprocessTaxa(vh_file,"Family")
processed_taxa <- VhgAddPhylum(vh_file_filtered,"ViralRefSeq_taxonomy")
print(unique(processed_taxa$Phylum))
?VhgBoxplot
path <- system.file("extdata", "virushunter.tsv", package = "Virusparies")
file <- ImportVirusTable(path)
# plot 1 for e-values
plot1 <- VhgBoxplot(file, x_column = "best_query", y_column = "ViralRefSeq_E")
plot1
t <- ImportVirusTable("/media/sergej/EXTERNAL_US/git_clone/RscriptsMasterthesis/data/RNAvirus_Mammals_newJan2023/mammals/combined_ga.tsv")
?VhgRunsBarplot
VhgRunsBarplot(t,groupby = "ViralRefSeq_taxonomy",cut = 1e-5)
VhgAddPhylum(t,"ViralRefSeq_taxonomy")
t <- VhgAddPhylum(t,"ViralRefSeq_taxonomy")
View(t)
library(devtools)
document()
check()
