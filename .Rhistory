load_all()
VhgRunsBarplot(file,cut = 1e-5,group_unwanted_phyla = "rna",plot_text = 2)
gsub("% %","%",t$sample_run$perc)
load_all()
VhgRunsBarplot(file,cut = 1e-5,group_unwanted_phyla = "rna",plot_text = 2)
load_all()
VhgRunsBarplot(file,cut = 1e-5,group_unwanted_phyla = "rna",plot_text = 2)
load_all()
VhgRunsBarplot(file,cut = 1e-5,group_unwanted_phyla = "rna",plot_text = 2)
load_all()
VhgRunsBarplot(file,cut = 1e-5,group_unwanted_phyla = "rna",plot_text = 2)
load_all()
VhgRunsBarplot(file,cut = 1e-5,group_unwanted_phyla = "rna",plot_text = 2)
load_all()
VhgRunsBarplot(file,cut = 1e-5,group_unwanted_phyla = "rna",plot_text = 2)
VhgRunsBarplot(file,cut = 1e-5,group_unwanted_phyla = "rna",plot_text = 3)
VhgRunsBarplot(file,cut = 1e-5,group_unwanted_phyla = "rna",plot_text = 1)
?VhSumHitsBarplot
path <- system.file("extdata", "virushunter.tsv", package = "Virusparies")
vh_file <- ImportVirusTable(path)
VhSumHitsBarplot(vh_file,cut = 1e-5)
VhSumHitsBarplot(vh_file,cut = 1e-5,group_unwanted_phyla = "rna")
load_all()
VhSumHitsBarplot(vh_file,cut = 1e-5,group_unwanted_phyla = "rna")
22/12704
VhSumHitsBarplot(vh_file,cut = 1e-5)
library(devtools)
document()
check()
check()
check()
check()
check()
check()
load_all()
?VhgRunsBarplot
path <- system.file("extdata", "virushunter.tsv", package = "Virusparies")
file <- ImportVirusTable(path)
# plot 1: plot boxplot for "identity"
plot <- VhgRunsBarplot(file,cut = 1e-5)
path <- system.file("extdata", "virushunter.tsv", package = "Virusparies")
file <- ImportVirusTable(path)
# plot 1: plot boxplot for "identity"
VhgRunsBarplot(file,cut = 1e-5,group_unwanted_phyla = "rna")
load_all()
path <- system.file("extdata", "virushunter.tsv", package = "Virusparies")
file <- ImportVirusTable(path)
# plot 1: plot boxplot for "identity"
VhgRunsBarplot(file,cut = 1e-5,group_unwanted_phyla = "rna")
load_all()
path <- system.file("extdata", "virushunter.tsv", package = "Virusparies")
file <- ImportVirusTable(path)
# plot 1: plot boxplot for "identity"
VhgRunsBarplot(file,cut = 1e-5,group_unwanted_phyla = "rna")
load_all()
path <- system.file("extdata", "virushunter.tsv", package = "Virusparies")
file <- ImportVirusTable(path)
# plot 1: plot boxplot for "identity"
VhgRunsBarplot(file,cut = 1e-5,group_unwanted_phyla = "rna")
load_all()
path <- system.file("extdata", "virushunter.tsv", package = "Virusparies")
file <- ImportVirusTable(path)
# plot 1: plot boxplot for "identity"
VhgRunsBarplot(file,cut = 1e-5,group_unwanted_phyla = "rna")
load_all()
path <- system.file("extdata", "virushunter.tsv", package = "Virusparies")
file <- ImportVirusTable(path)
# plot 1: plot boxplot for "identity"
VhgRunsBarplot(file,cut = 1e-5,group_unwanted_phyla = "rna")
load_all()
path <- system.file("extdata", "virushunter.tsv", package = "Virusparies")
file <- ImportVirusTable(path)
# plot 1: plot boxplot for "identity"
VhgRunsBarplot(file,cut = 1e-5,group_unwanted_phyla = "rna")
load_all()
path <- system.file("extdata", "virushunter.tsv", package = "Virusparies")
file <- ImportVirusTable(path)
# plot 1: plot boxplot for "identity"
VhgRunsBarplot(file,cut = 1e-5,group_unwanted_phyla = "rna")
load_all()
path <- system.file("extdata", "virushunter.tsv", package = "Virusparies")
file <- ImportVirusTable(path)
# plot 1: plot boxplot for "identity"
VhgRunsBarplot(file,cut = 1e-5,group_unwanted_phyla = "rna")
load_all()
path <- system.file("extdata", "virushunter.tsv", package = "Virusparies")
file <- ImportVirusTable(path)
# plot 1: plot boxplot for "identity"
VhgRunsBarplot(file,cut = 1e-5,group_unwanted_phyla = "rna")
load_all()
path <- system.file("extdata", "virushunter.tsv", package = "Virusparies")
file <- ImportVirusTable(path)
# plot 1: plot boxplot for "identity"
VhgRunsBarplot(file,cut = 1e-5,group_unwanted_phyla = "rna")
rlang::last_trace()
path <- system.file("extdata", "virushunter.tsv", package = "Virusparies")
file <- ImportVirusTable(path)
# plot 1: plot boxplot for "identity"
VhgRunsBarplot(file,cut = 1e-5,group_unwanted_phyla = "rna")
rlang::last_trace()
load_all()
path <- system.file("extdata", "virushunter.tsv", package = "Virusparies")
file <- ImportVirusTable(path)
# plot 1: plot boxplot for "identity"
VhgRunsBarplot(file,cut = 1e-5,group_unwanted_phyla = "rna")
load_all()
path <- system.file("extdata", "virushunter.tsv", package = "Virusparies")
file <- ImportVirusTable(path)
# plot 1: plot boxplot for "identity"
VhgRunsBarplot(file,cut = 1e-5,group_unwanted_phyla = "rna")
load_all()
path <- system.file("extdata", "virushunter.tsv", package = "Virusparies")
file <- ImportVirusTable(path)
# plot 1: plot boxplot for "identity"
VhgRunsBarplot(file,cut = 1e-5,group_unwanted_phyla = "rna")
load_all()
path <- system.file("extdata", "virushunter.tsv", package = "Virusparies")
file <- ImportVirusTable(path)
# plot 1: plot boxplot for "identity"
VhgRunsBarplot(file,cut = 1e-5,group_unwanted_phyla = "rna")
load_all()
path <- system.file("extdata", "virushunter.tsv", package = "Virusparies")
file <- ImportVirusTable(path)
# plot 1: plot boxplot for "identity"
VhgRunsBarplot(file,cut = 1e-5,group_unwanted_phyla = "rna")
load_all()
path <- system.file("extdata", "virushunter.tsv", package = "Virusparies")
file <- ImportVirusTable(path)
# plot 1: plot boxplot for "identity"
VhgRunsBarplot(file,cut = 1e-5,group_unwanted_phyla = "rna")
load_all()
path <- system.file("extdata", "virushunter.tsv", package = "Virusparies")
file <- ImportVirusTable(path)
# plot 1: plot boxplot for "identity"
VhgRunsBarplot(file,cut = 1e-5,group_unwanted_phyla = "rna")
load_all()
path <- system.file("extdata", "virushunter.tsv", package = "Virusparies")
file <- ImportVirusTable(path)
# plot 1: plot boxplot for "identity"
VhgRunsBarplot(file,cut = 1e-5,group_unwanted_phyla = "rna")
load_all()
path <- system.file("extdata", "virushunter.tsv", package = "Virusparies")
file <- ImportVirusTable(path)
# plot 1: plot boxplot for "identity"
VhgRunsBarplot(file,cut = 1e-5,group_unwanted_phyla = "rna")
load_all()
path <- system.file("extdata", "virushunter.tsv", package = "Virusparies")
file <- ImportVirusTable(path)
# plot 1: plot boxplot for "identity"
VhgRunsBarplot(file,cut = 1e-5,group_unwanted_phyla = "rna")
check()
check()
check()
check()
path <- system.file("extdata", "virushunter.tsv", package = "Virusparies")
file <- ImportVirusTable(path)
VhgRunsBarplot(file,cut = 1e-5,group_unwanted_phyla = "rna")
rlang::last_trace()
load_all()
VhgRunsBarplot(file,cut = 1e-5,group_unwanted_phyla = "rna")
load_all()
VhgRunsBarplot(file,cut = 1e-5,group_unwanted_phyla = "rna")
load_all()
VhgRunsBarplot(file,cut = 1e-5,group_unwanted_phyla = "rna")
load_all()
VhgRunsBarplot(file,cut = 1e-5,group_unwanted_phyla = "rna")
check()
check()
load_all()
VhgRunsBarplot(file,cut = 1e-5,group_unwanted_phyla = "rna")
VhgRunsBarplot(file,cut = 1e-5,group_unwanted_phyla = "rna",groupby = "ViralRefSeq_taxonomy")
check()
check()
VhgRunsBarplot(file,cut = 1e-5,group_unwanted_phyla = "rna",groupby = "ViralRefSeq_taxonomy")
VhgRunsBarplot(file,cut = 1e-5,group_unwanted_phyla = "rna")
?VhSumHitsBarplot
path <- system.file("extdata", "virushunter.tsv", package = "Virusparies")
vh_file <- ImportVirusTable(path)
VhSumHitsBarplot(vh_file,cut = 1e-5,group_unwanted_phyla = "rna")
check()
check()
?VhSumHitsBarplot
path <- system.file("extdata", "virushunter.tsv", package = "Virusparies")
vh_file <- ImportVirusTable(path)
VhSumHitsBarplot(vh_file,cut = 1e-5,group_unwanted_phyla = "rna")
VhSumHitsBarplot(vh_file,cut = 1e-5)
VhSumHitsBarplot(vh_file,cut = 1e-5,group_unwanted_phyla = "rna",groupby = "ViralRefSeq_taxonomy")
?VhgRunsBarplot
path <- system.file("extdata", "virushunter.tsv", package = "Virusparies")
file <- ImportVirusTable(path)
VhgRunsBarplot(file,cut = 1e-5,group_unwanted_phyla = "rna",groupby = "ViralRefSeq_taxonomy")
library(devtools)
load_all()
?VhgRunsBarplot
# import data
path <- system.file("extdata", "virushunter.tsv", package = "Virusparies")
file <- ImportVirusTable(path)
VhgRunsBarplot(file,cut = 1e-5,group_unwanted_phyla = "rna",groupby = "ViralRefSeq_taxonomy")
load_all()
VhgRunsBarplot(file,cut = 1e-5,group_unwanted_phyla = "rna",groupby = "ViralRefSeq_taxonomy")
VhgRunsBarplot(file,cut = 1e-5,group_unwanted_phyla = "rna")
load_all()
VhgRunsBarplot(file,cut = 1e-5,group_unwanted_phyla = "rna",groupby = "ViralRefSeq_taxonomy")
load_all()
VhgRunsBarplot(file,cut = 1e-5,group_unwanted_phyla = "rna",groupby = "ViralRefSeq_taxonomy")
load_all()
VhgRunsBarplot(file,cut = 1e-5,group_unwanted_phyla = "rna",groupby = "ViralRefSeq_taxonomy")
load_all()
VhgRunsBarplot(file,cut = 1e-5,group_unwanted_phyla = "rna",groupby = "ViralRefSeq_taxonomy")
load_all()
VhgRunsBarplot(file,cut = 1e-5,group_unwanted_phyla = "rna",groupby = "ViralRefSeq_taxonomy")
load_all()
VhgRunsBarplot(file,cut = 1e-5,group_unwanted_phyla = "rna",groupby = "ViralRefSeq_taxonomy")
load_all()
VhgRunsBarplot(file,cut = 1e-5,group_unwanted_phyla = "rna",groupby = "ViralRefSeq_taxonomy")
load_all()
VhgRunsBarplot(file,cut = 1e-5,group_unwanted_phyla = "rna",groupby = "ViralRefSeq_taxonomy")
load_all()
VhgRunsBarplot(file,cut = 1e-5,group_unwanted_phyla = "rna",groupby = "ViralRefSeq_taxonomy")
load_all()
VhgRunsBarplot(file,cut = 1e-5,group_unwanted_phyla = "rna",groupby = "ViralRefSeq_taxonomy")
load_all()
VhgRunsBarplot(file,cut = 1e-5,group_unwanted_phyla = "rna",groupby = "ViralRefSeq_taxonomy")
load_all()
VhgRunsBarplot(file,cut = 1e-5,group_unwanted_phyla = "rna",groupby = "ViralRefSeq_taxonomy")
load_all()
VhgRunsBarplot(file,cut = 1e-5,group_unwanted_phyla = "rna",groupby = "ViralRefSeq_taxonomy")
load_all()
VhgRunsBarplot(file,cut = 1e-5,group_unwanted_phyla = "rna",groupby = "ViralRefSeq_taxonomy")
load_all()
VhgRunsBarplot(file,cut = 1e-5,group_unwanted_phyla = "rna",groupby = "ViralRefSeq_taxonomy")
load_all()
VhgRunsBarplot(file,cut = 1e-5,group_unwanted_phyla = "rna",groupby = "ViralRefSeq_taxonomy")
load_all()
VhgRunsBarplot(file,cut = 1e-5,group_unwanted_phyla = "rna",groupby = "ViralRefSeq_taxonomy")
load_all()
VhgRunsBarplot(file,cut = 1e-5,group_unwanted_phyla = "rna",groupby = "ViralRefSeq_taxonomy")
load_all()
VhgRunsBarplot(file,cut = 1e-5,group_unwanted_phyla = "rna",groupby = "ViralRefSeq_taxonomy")
load_all()
VhgRunsBarplot(file,cut = 1e-5,group_unwanted_phyla = "rna",groupby = "ViralRefSeq_taxonomy")
load_all()
VhgRunsBarplot(file,cut = 1e-5,group_unwanted_phyla = "rna",groupby = "ViralRefSeq_taxonomy")
load_all()
VhgRunsBarplot(file,cut = 1e-5,group_unwanted_phyla = "rna",groupby = "ViralRefSeq_taxonomy")
load_all()
VhgRunsBarplot(file,cut = 1e-5,group_unwanted_phyla = "rna",groupby = "ViralRefSeq_taxonomy")
load_all()
load_all()
VhgRunsBarplot(file,cut = 1e-5,group_unwanted_phyla = "rna",groupby = "ViralRefSeq_taxonomy")
load_all()
VhgRunsBarplot(file,cut = 1e-5,group_unwanted_phyla = "rna",groupby = "ViralRefSeq_taxonomy")
load_all()
VhgRunsBarplot(file,cut = 1e-5,group_unwanted_phyla = "rna",groupby = "ViralRefSeq_taxonomy")
load_all()
VhgRunsBarplot(file,cut = 1e-5,group_unwanted_phyla = "rna",groupby = "ViralRefSeq_taxonomy")
VhgRunsBarplot(file,cut = 1e-5,group_unwanted_phyla = "rna")
VhgRunsBarplot(file,cut = 1e-5,groupby = "ViralRefSeq_taxonomy")
load_all()
VhgRunsBarplot(file,cut = 1e-5,group_unwanted_phyla = "rna")
VhgRunsBarplot(file,cut = 1e-5)
VhgRunsBarplot(file,cut = 1e-5,group_unwanted_phyla = "rna",groupby = "ViralRefSeq_taxonomy")
document()
check()
check()
VhgRunsBarplot(file,cut = 1e-5,group_unwanted_phyla = "smalldna",groupby = "ViralRefSeq_taxonomy")
VhgRunsBarplot(file,cut = 1e-5,group_unwanted_phyla = "rna",groupby = "ViralRefSeq_taxonomy")
VhgRunsBarplot(file,cut = 1e-5,group_unwanted_phyla ="rna",groupby = "ViralRefSeq_taxonomy")
VhgRunsBarplot(file,cut = 1e-5,group_unwanted_phyla = "smalldna",groupby = "ViralRefSeq_taxonomy")
load_all()
VhgRunsBarplot(file,cut = 1e-5,group_unwanted_phyla = "smalldna",groupby = "ViralRefSeq_taxonomy")
load_all()
VhgRunsBarplot(file,cut = 1e-5,group_unwanted_phyla = "smalldna",groupby = "ViralRefSeq_taxonomy")
VhgRunsBarplot(file,cut = 1e-5,group_unwanted_phyla = "largedna",groupby = "ViralRefSeq_taxonomy")
VhgRunsBarplot(file,cut = 1e-5,group_unwanted_phyla = "rna",groupby = "ViralRefSeq_taxonomy")
VhgRunsBarplot(file,cut = 1e-5,group_unwanted_phyla = "rna")
VhgRunsBarplot(file,cut = 1e-5,group_unwanted_phyla = "smalldna")
check()
library(devtools)
load_all()
?VhSumHitsBarplot
path <- system.file("extdata", "virushunter.tsv", package = "Virusparies")
vh_file <- ImportVirusTable(path)
VhSumHitsBarplot(vh_file,cut = 1e-5)
VhSumHitsBarplot(vh_file,cut = 1e-5,group_unwanted_phyla = "rna")
VhSumHitsBarplot(vh_file,cut = 1e-5,group_unwanted_phyla = "rna",groupby = "ViralRefSeq_taxonomy")
load_all()
VhSumHitsBarplot(vh_file,cut = 1e-5,group_unwanted_phyla = "rna",groupby = "ViralRefSeq_taxonomy")
load_all()
VhSumHitsBarplot(vh_file,cut = 1e-5,group_unwanted_phyla = "rna",groupby = "ViralRefSeq_taxonomy")
load_all()
VhSumHitsBarplot(vh_file,cut = 1e-5,group_unwanted_phyla = "rna",groupby = "ViralRefSeq_taxonomy")
load_all()
VhSumHitsBarplot(vh_file,cut = 1e-5,group_unwanted_phyla = "rna",groupby = "ViralRefSeq_taxonomy")
VhSumHitsBarplot(vh_file,cut = 1e-5,group_unwanted_phyla = "rna")
VhSumHitsBarplot(vh_file,cut = 1e-5)
rlang::last_trace()
load_all()
VhSumHitsBarplot(vh_file,cut = 1e-5,group_unwanted_phyla = "rna")
load_all()
VhSumHitsBarplot(vh_file,cut = 1e-5,group_unwanted_phyla = "rna")
rlang::last_trace()
VhSumHitsBarplot(vh_file,cut = 1e-5,group_unwanted_phyla = "rna")
load_all()
VhSumHitsBarplot(vh_file,cut = 1e-5,group_unwanted_phyla = "rna")
load_all()
VhSumHitsBarplot(vh_file,cut = 1e-5,group_unwanted_phyla = "rna")
VhSumHitsBarplot(vh_file,cut = 1e-5,group_unwanted_phyla = "rna",groupby = "ViralRefSeq_taxonomy")
VhSumHitsBarplot(vh_file,cut = 1e-5,group_unwanted_phyla = "rna",groupby = "ViralRefSeq_taxonomy",plot_text = 2)
load_all()
VhSumHitsBarplot(vh_file,cut = 1e-5,group_unwanted_phyla = "rna",groupby = "ViralRefSeq_taxonomy",plot_text = 2)
load_all()
VhSumHitsBarplot(vh_file,cut = 1e-5,group_unwanted_phyla = "rna",groupby = "ViralRefSeq_taxonomy",plot_text = 2)
load_all()
VhSumHitsBarplot(vh_file,cut = 1e-5,group_unwanted_phyla = "rna",groupby = "ViralRefSeq_taxonomy",plot_text = 2)
VhSumHitsBarplot(vh_file,cut = 1e-5,group_unwanted_phyla = "rna",groupby = "ViralRefSeq_taxonomy",plot_text = 3)
VhSumHitsBarplot(vh_file,cut = 1e-5,group_unwanted_phyla = "rna",groupby = "ViralRefSeq_taxonomy",plot_text = 1)
check()
check()
load_all()
VhSumHitsBarplot(vh_file,cut = 1e-5,group_unwanted_phyla = "rna",groupby = "ViralRefSeq_taxonomy",plot_text = 1)
VhSumHitsBarplot(vh_file,cut = 1e-5,groupby = "ViralRefSeq_taxonomy",plot_text = 1)
library(devtools)
document()
check()
document()
?VhgGetSubject
# import data
path <- system.file("extdata", "virushunter.tsv", package = "Virusparies")
file <- ImportVirusTable(path)
VhgPreprocessTaxa(file,taxa_rank = "Family")
file_filtered <- VhgSubsetHittable(file,ViralRefSeq_E_criteria = 1e-5)
VhgGetSubject(file_filtered,groupby = "ViralRefSeq_taxonomy",
remove_identifiers = TRUE)
VhgGetSubject(file_filtered,groupby = "ViralRefSeq_taxonomy",
remove_identifiers = TRUE,group_unwanted_phyla = "rna")
file <- VhgPreprocessTaxa(file,taxa_rank = "Family")
file_filtered <- VhgSubsetHittable(file,ViralRefSeq_E_criteria = 1e-5)
VhgGetSubject(file_filtered,groupby = "ViralRefSeq_taxonomy",
remove_identifiers = TRUE,group_unwanted_phyla = "rna")
load_all()
VhgGetSubject(file_filtered,groupby = "ViralRefSeq_taxonomy",
remove_identifiers = TRUE,group_unwanted_phyla = "rna")
t <- VhgGetSubject(file_filtered,groupby = "ViralRefSeq_taxonomy",
remove_identifiers = TRUE,group_unwanted_phyla = "rna")
View(t)
View(file)
rm(list = ls())
path <- system.file("extdata", "virushunter.tsv", package = "Virusparies")
file <- ImportVirusTable(path)
file_filtered <- VhgSubsetHittable(file,ViralRefSeq_E_criteria = 1e-5)
VhgGetSubject(file_filtered,groupby = "ViralRefSeq_taxonomy",
remove_identifiers = TRUE,group_unwanted_phyla = "rna")
document()
?Virusparies
document()
document()
load_all()
?SummarizeViralStats
path <- system.file("extdata", "virushunter.tsv", package = "Virusparies")
file <- ImportVirusTable(path)
SummarizeViralStats(file=file,
groupby = "best_query",
metric = "ViralRefSeq_ident",
metric_cutoff = 90,
show_total = TRUE,
filter_cutoff = 1e-5,
extra_stats = c("median","Q1","Q3"))
SummarizeViralStats(file=file,
groupby = "best_query",
metric = "ViralRefSeq_ident",
metric_cutoff = 90,
show_total = TRUE,
filter_cutoff = 1e-5,
extra_stats = c("median","Q1","Q3"),group_unwanted_phyla = "rna")
file <- VhgPreprocessTaxa(file,"Family")
SummarizeViralStats(file=file,
groupby = "best_query",
metric = "ViralRefSeq_ident",
metric_cutoff = 90,
show_total = TRUE,
filter_cutoff = 1e-5,
extra_stats = c("median","Q1","Q3"),group_unwanted_phyla = "rna")
View(file)
View(file_filtered)
file <- VhgPreprocessTaxa(file,"Genus")
path <- system.file("extdata", "virushunter.tsv", package = "Virusparies")
file <- ImportVirusTable(path)
file <- VhgPreprocessTaxa(file,"Genus")
SummarizeViralStats(file=file,
groupby = "best_query",
metric = "ViralRefSeq_ident",
metric_cutoff = 90,
show_total = TRUE,
filter_cutoff = 1e-5,
extra_stats = c("median","Q1","Q3"),group_unwanted_phyla = "rna")
SummarizeViralStats(file=file,
groupby = "ViralRefSeq_taxonomy",
metric = "ViralRefSeq_ident",
metric_cutoff = 90,
show_total = TRUE,
filter_cutoff = 1e-5,
extra_stats = c("median","Q1","Q3"),group_unwanted_phyla = "rna")
load_all()
?VhgGetSubject
# import data
path <- system.file("extdata", "virushunter.tsv", package = "Virusparies")
file <- ImportVirusTable(path)
# process column and filter for significant groups
file <- VhgPreprocessTaxa(file,taxa_rank = "Family")
file_filtered <- VhgSubsetHittable(file,ViralRefSeq_E_criteria = 1e-5)
VhgGetSubject(file_filtered,groupby = "ViralRefSeq_taxonomy",
remove_identifiers = TRUE,extract_brackets = TRUE)
file <- ImportVirusTable("/media/sergej/EXTERNAL_US/git_clone/RscriptsMasterthesis/data/RNAvirus_Mammals_newJan2023/mammals/combined_ga.tsv")
# process column and filter for significant groups
file <- VhgPreprocessTaxa(file,taxa_rank = "Family")
file_filtered <- VhgSubsetHittable(file,ViralRefSeq_E_criteria = 1e-5)
VhgGetSubject(file_filtered,groupby = "ViralRefSeq_taxonomy",
remove_identifiers = TRUE)
VhgGetSubject(file_filtered,groupby = "ViralRefSeq_taxonomy",
remove_identifiers = FALSE)
VhgGetSubject(file_filtered,groupby = "ViralRefSeq_taxonomy",
remove_identifiers = TRUE,extract_brackets = TRUE)
t<-VhgGetSubject(file_filtered,groupby = "ViralRefSeq_taxonomy",
remove_identifiers = TRUE,extract_brackets = TRUE)
View(t)
546+193
load_all()
VhgGetSubject(file_filtered,groupby = "ViralRefSeq_taxonomy",
remove_identifiers = TRUE)
VhgGetSubject(file_filtered,groupby = "ViralRefSeq_taxonomy",
remove_identifiers = TRUE)
load_all()
VhgGetSubject(file_filtered,groupby = "ViralRefSeq_taxonomy",
remove_identifiers = TRUE)
load_all()
VhgGetSubject(file_filtered,groupby = "ViralRefSeq_taxonomy",
remove_identifiers = TRUE)
load_all()
VhgGetSubject(file_filtered,groupby = "ViralRefSeq_taxonomy",
remove_identifiers = TRUE)
load_all()
VhgGetSubject(file_filtered,groupby = "ViralRefSeq_taxonomy",
remove_identifiers = TRUE)
VhgGetSubject(file_filtered,groupby = "ViralRefSeq_taxonomy",
remove_identifiers = FALSE)
VhgGetSubject(file_filtered,groupby = "ViralRefSeq_taxonomy",
remove_identifiers = FALSE,include_run_ids = TRUE)
VhgGetSubject(file_filtered,groupby = "ViralRefSeq_taxonomy",
remove_identifiers = FALSE,group_unwanted_phyla = "rna")
VhgGetSubject(file_filtered,groupby = "ViralRefSeq_taxonomy",
remove_identifiers = FALSE,group_unwanted_phyla = "rna",extract_brackets = TRUE)
VhgGetSubject(file_filtered,groupby = "ViralRefSeq_taxonomy",
remove_identifiers = FALSE)
file <- "acc:YP_001096179|unnamed protein product [Cyprinid herpesvirus 3] "
file %>%
# Remove everything before and including the first '|'
mutate(Processed_ViralRefSeq_subject = if (remove_identifiers) {
sub("^.*?\\|", "", .data$ViralRefSeq_subject)
} else {
.data$ViralRefSeq_subject
})
document()
load_all()
# import data
path <- system.file("extdata", "virushunter.tsv", package = "Virusparies")
file <- ImportVirusTable(path)
# process column and filter for significant groups
file <- VhgPreprocessTaxa(file,taxa_rank = "Family")
file_filtered <- VhgSubsetHittable(file,ViralRefSeq_E_criteria = 1e-5)
VhgGetSubject(file_filtered,groupby = "ViralRefSeq_taxonomy",
remove_identifiers = TRUE)
VhgGetSubject(file_filtered,groupby = "ViralRefSeq_taxonomy",
remove_identifiers = FALSE)
load_all()
VhgGetSubject(file_filtered,groupby = "ViralRefSeq_taxonomy",
remove_identifiers = FALSE)
VhgGetSubject(file_filtered,groupby = "ViralRefSeq_taxonomy",
remove_identifiers = TRUE)
load_all()
VhgGetSubject(file_filtered,groupby = "ViralRefSeq_taxonomy",
remove_identifiers = TRUE)
file <- ImportVirusTable("/media/sergej/EXTERNAL_US/git_clone/RscriptsMasterthesis/data/RNAvirus_Mammals_newJan2023/mammals/combined_ga.tsv")
# process column and filter for significant groups
file <- VhgPreprocessTaxa(file,taxa_rank = "Family")
file_filtered <- VhgSubsetHittable(file,ViralRefSeq_E_criteria = 1e-5)
VhgGetSubject(file_filtered,groupby = "ViralRefSeq_taxonomy",
remove_identifiers = TRUE)
VhgGetSubject(file_filtered,groupby = "ViralRefSeq_taxonomy",
remove_identifiers = TRUE,extract_brackets = TRUE)
VhgGetSubject(file_filtered,groupby = "ViralRefSeq_taxonomy",
remove_identifiers = FALSE,extract_brackets = TRUE)
VhgGetSubject(file_filtered,groupby = "ViralRefSeq_taxonomy",
remove_identifiers = TRUE)
document()
check()
document()
check()
load_all()
library(devtools)
load_all()
?VhSumHitsBarplot
path <- system.file("extdata", "virushunter.tsv", package = "Virusparies")
vh_file <- ImportVirusTable(path)
names(vh_file)
vh_file[[,13]]
vh_file[,13]
document()
load_all()
VhSumHitsBarplot(vh_file,cut = 1e-5)
VhSumHitsBarplot(vh_file,cut = 1e-5,y_column = "ViralRefSeq_contigs")
check()
