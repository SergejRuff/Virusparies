if (!grepl("unclassified \\+ phylum|unclassified", virus_name, ignore.case = TRUE)) {
for (j in seq_along(taxa_list)) {
if (grepl(taxa_list[j], virus_name, ignore.case = TRUE)) {
ranks <- c(ranks, taxa_names[j])
break
}
}
}
}
if (length(ranks) == 0) {
return("No valid taxonomic rank found")
}
most_common_rank <- names(sort(table(ranks), decreasing = TRUE))[1]
return(most_common_rank)
}
# Example usage
virus_names <- c("Coronavirus", "Adenovirales", "Picornaviridae", "Herpesvirinae", "unclassified + phylum", "unclassified", "Flavivirus")
most_common_rank <- get_most_common_taxonomic_rank(virus_names)
print(most_common_rank)
virus_names <- c("Coronavirus", "Adenovirus", "Coronavirus", "Herpesvirus", "unclassified + phylum", "unclassified", "Flavivirus")
most_common_rank <- get_most_common_taxonomic_rank(virus_names)
print(most_common_rank)
virus_names <- c( "Adenovirus", "unclassified + phylum", "unclassified", )
virus_names <- c( "Adenovirus", "unclassified + phylum", "unclassified" )
most_common_rank <- get_most_common_taxonomic_rank(virus_names)
print(most_common_rank)
virus_names <- c( "Adenovirus", "Adenovirales","virales", "unclassified + phylum", "unclassified" )
most_common_rank <- get_most_common_taxonomic_rank(virus_names)
print(most_common_rank)
virus_names <- c( "unclassified + phylum", "unclassified" )
most_common_rank <- get_most_common_taxonomic_rank(virus_names)
print(most_common_rank)
library(Virusparies)
?VhgBoxplot
path <- system.file("extdata", "virushunter.tsv", package = "Virusparies")
file <- ImportVirusTable(path)
?VhgPreprocessTaxa
path <- system.file("extdata", "virushunter.tsv", package = "Virusparies")
vh_file <- ImportVirusTable(path)
vh_file_filtered <- VhgPreprocessTaxa(vh_file,"Family")
get_most_common_taxonomic_rank(vh_file_filtered)
get_most_common_taxonomic_rank(vh_file_filtered$ViralRefSeq_taxonomy)
vh_file_filtered <- VhgPreprocessTaxa(vh_file,"Order")
get_most_common_taxonomic_rank(vh_file_filtered$ViralRefSeq_taxonomy)
vh_file[["ViralRefSeq_taxonomy"]]
# Function to get the most common taxonomic rank based on suffix
get_most_common_taxonomic_rank <- function(virus_names) {
ranks <- c()
for (virus_name in virus_names) {
if (!grepl("unclassified \\+ phylum|unclassified", virus_name, ignore.case = TRUE)) {
for (j in seq_along(taxa_list)) {
if (grepl(taxa_list[j], virus_name, ignore.case = TRUE)) {
ranks <- c(ranks, taxa_names[j])
break
}
}
}
}
if (length(ranks) == 0) {
return("unclassified")
}
most_common_rank <- names(sort(table(ranks), decreasing = TRUE))[1]
return(most_common_rank)
}
get_most_common_taxonomic_rank(c("unclassified + phylum", "unclassified"))
unique(vh_file$ViralRefSeq_taxonomy)
unique(vh_file_filtered$ViralRefSeq_taxonomy)
# Function to get the most common taxonomic rank based on suffix
get_most_common_taxonomic_rank <- function(virus_names) {
ranks <- c()
for (virus_name in virus_names) {
if (!grepl("unclassified", virus_name, ignore.case = TRUE)) {
for (j in seq_along(taxa_list)) {
if (grepl(taxa_list[j], virus_name, ignore.case = TRUE)) {
ranks <- c(ranks, taxa_names[j])
break
}
}
}
}
if (length(ranks) == 0) {
return("unclassified")
}
most_common_rank <- names(sort(table(ranks), decreasing = TRUE))[1]
return(most_common_rank)
}
# Example data frame
file <- data.frame(
ViralRefSeq_taxonomy = c("unclassified + phylum Firmicutes", "unclassified", "unclassified univiricota", "Coronavirus", "Adenovirales", "Picornaviridae"),
stringsAsFactors = FALSE
)
# Check the groupby condition
groupby <- "ViralRefSeq_taxonomy"
# Get the most common taxonomic rank
taxa_rank <- get_most_common_taxonomic_rank(file[[groupby]])
taxa_rank
# Example data frame
file <- data.frame(
ViralRefSeq_taxonomy = c("unclassified + phylum Firmicutes", "unclassified", "unclassified univiricota"),
stringsAsFactors = FALSE
)
# Check the groupby condition
groupby <- "ViralRefSeq_taxonomy"
# Get the most common taxonomic rank
taxa_rank <- get_most_common_taxonomic_rank(file[[groupby]])
taxa_rank
if (taxa_rank == "unclassified") {
# Create the Phylum column based on ViralRefSeq_taxonomy
file$Phylum <- ifelse(grepl("unclassified", file[[groupby]], ignore.case = TRUE),
ifelse(grepl("unclassified\\s+(\\S+)", file[[groupby]], ignore.case = TRUE),
gsub("unclassified\\s+", "", file[[groupby]]),
"unclassified"),
NA)
}
print(file)
document()
document()
document()
check()
document()
check()
check()
load_all()
install()
document()
library(Virusparies)
?VhgAddPhylum
path <- system.file("extdata", "virushunter.tsv", package = "Virusparies")
vh_file <- ImportVirusTable(path)
vh_file_filtered <- VhgPreprocessTaxa(vh_file,"Family")
processed_taxa <- VhgAddPhylum(vh_file_filtered,"ViralRefSeq_taxonomy")
print(head(processed_taxa$Phylum))
View(vh_file)
View(processed_taxa)
document()
load_all()
?VhgAddPhylum
path <- system.file("extdata", "virushunter.tsv", package = "Virusparies")
vh_file <- ImportVirusTable(path)
vh_file_filtered <- VhgPreprocessTaxa(vh_file,"Family")
processed_taxa <- VhgAddPhylum(vh_file_filtered,"ViralRefSeq_taxonomy")
print(head(processed_taxa$Phylum))
document()
load_all()
?VhgAddPhylum
path <- system.file("extdata", "virushunter.tsv", package = "Virusparies")
vh_file <- ImportVirusTable(path)
vh_file_filtered <- VhgPreprocessTaxa(vh_file,"Family")
processed_taxa <- VhgAddPhylum(vh_file_filtered,"ViralRefSeq_taxonomy")
print(head(processed_taxa$Phylum))
# Function to get the most common taxonomic rank based on suffix
get_most_common_taxonomic_rank <- function(virus_names) {
# Define the list with values
taxa_list <- list(
"viricotina",
"viricetes",
"viricetidae",
"virales",
"virineae",
"viridae",
"virinae",
"virus"
)
ranks <- c()
for (virus_name in virus_names) {
if (!grepl("unclassified \\+ phylum|unclassified", virus_name, ignore.case = TRUE)) {
for (suffix in taxa_list) {
if (grepl(suffix, virus_name, ignore.case = TRUE)) {
ranks <- c(ranks, suffix)
break
}
}
}
}
if (length(ranks) == 0) {
return("unclassified")
}
most_common_suffix <- names(sort(table(ranks), decreasing = TRUE))[1]
return(most_common_suffix)
}
# Example usage
virus_names <- c("Coronavirus", "Adenovirales", "Picornaviridae", "Herpesvirinae", "unclassified + phylum", "unclassified", "Flavivirus")
most_common_rank <- get_most_common_taxonomic_rank(virus_names)
print(most_common_rank)
document()
load_all()
?VhgAddPhylum
path <- system.file("extdata", "virushunter.tsv", package = "Virusparies")
vh_file <- ImportVirusTable(path)
vh_file_filtered <- VhgPreprocessTaxa(vh_file,"Family")
processed_taxa <- VhgAddPhylum(vh_file_filtered,"ViralRefSeq_taxonomy")
print(head(processed_taxa$Phylum))
path <- system.file("extdata", "virushunter.tsv", package = "Virusparies")
vh_file <- ImportVirusTable(path)
vh_file_filtered <- VhgPreprocessTaxa(vh_file,"Family")
processed_taxa <- VhgAddPhylum(vh_file_filtered)
print(head(processed_taxa$Phylum))
path <- system.file("extdata", "virushunter.tsv", package = "Virusparies")
vh_file <- ImportVirusTable(path)
vh_file_filtered <- VhgPreprocessTaxa(vh_file,"Family")
processed_taxa <- VhgAddPhylum(vh_file_filtered)
print(head(processed_taxa$Phylum))
head(vh_file_filtered$ViralRefSeq_taxonomy)
unique(processed_taxa$Phylum)
load_all()
?VhgAddPhylum
path <- system.file("extdata", "virushunter.tsv", package = "Virusparies")
vh_file <- ImportVirusTable(path)
vh_file_filtered <- VhgPreprocessTaxa(vh_file,"Family")
processed_taxa <- VhgAddPhylum(vh_file_filtered,"ViralRefSeq_taxonomy")
unique(processed_taxa$Phylum)
document()
load_all()
document()
load_all()
?VhgAddPhylum
path <- system.file("extdata", "virushunter.tsv", package = "Virusparies")
vh_file <- ImportVirusTable(path)
vh_file_filtered <- VhgPreprocessTaxa(vh_file,"Family")
processed_taxa <- VhgAddPhylum(vh_file_filtered,"ViralRefSeq_taxonomy")
print(unique(processed_taxa$Phylum))
document()
check()
document()
check()
load_all()
?VhgAddPhylum
path <- system.file("extdata", "virushunter.tsv", package = "Virusparies")
vh_file <- ImportVirusTable(path)
vh_file_filtered <- VhgPreprocessTaxa(vh_file,"Family")
processed_taxa <- VhgAddPhylum(vh_file_filtered,"ViralRefSeq_taxonomy")
print(unique(processed_taxa$Phylum))
View(processed_taxa)
?VhgBoxplot
# import gatherer files
path2 <- system.file("extdata", "virusgatherer.tsv", package = "Virusparies")
vg_file <- ImportVirusTable(path2)
vg_file <- VhgPreprocessTaxa(vg_file,"Family")
test <- VhgAddPhylum(vg_file)
test <- VhgAddPhylum(vg_file,"ViralRefSeq_taxonomy")
unique(test$Phylum)
View(test)
# Create an example data frame
example_data <- data.frame(
ID = 1:5,
ViralRefSeq_taxonomy = c(
"unclassified",
"unclassified Uroviricota",
"unclassified",
"unclassified Uroviricota",
"unclassified"
),
stringsAsFactors = FALSE
)
# Print the example data
print(example_data)
VhgAddPhylum(example_data,"ViralRefSeq_taxonomy")
# Create an example data frame
example_data <- data.frame(
ID = 1:5,
ViralRefSeq_taxonomy = c(
"taxid:unclassified",
"unclassified Uroviricota",
"unclassified",
"unclassified Uroviricota",
"unclassified"
),
stringsAsFactors = FALSE
)
# Print the example data
print(example_data)
VhgAddPhylum(example_data,"ViralRefSeq_taxonomy")
# Create an example data frame
example_data <- data.frame(
ID = 1:5,
ViralRefSeq_taxonomy = c(
"taxid:unclassified",
"taxid:unclassified Uroviricota",
"taxid:unclassified",
"taxid:unclassified Uroviricota",
"taxid:unclassified"
),
stringsAsFactors = FALSE
)
# Print the example data
print(example_data)
VhgAddPhylum(example_data,"ViralRefSeq_taxonomy")
?`Virusparies-package`
load_all()
load_all()
?VgConLenViolin
# import gatherer files
path2 <- system.file("extdata", "virusgatherer.tsv", package = "Virusparies")
vg_file <- ImportVirusTable(path2)
# create a violinplot.
violinplot <- VgConLenViolin(vg_file=vg_file,cut = 1e-5,log10_scale = TRUE)
violinplot
load_all()
# import gatherer files
path2 <- system.file("extdata", "virusgatherer.tsv", package = "Virusparies")
vg_file <- ImportVirusTable(path2)
# create a violinplot.
violinplot <- VgConLenViolin(vg_file=vg_file,cut = 1e-5,log10_scale = TRUE)
load_all()
# import gatherer files
path2 <- system.file("extdata", "virusgatherer.tsv", package = "Virusparies")
vg_file <- ImportVirusTable(path2)
# create a violinplot.
violinplot <- VgConLenViolin(vg_file=vg_file,cut = 1e-5,log10_scale = TRUE)
violinplot
load_all()
# import gatherer files
path2 <- system.file("extdata", "virusgatherer.tsv", package = "Virusparies")
vg_file <- ImportVirusTable(path2)
# create a violinplot.
violinplot <- VgConLenViolin(vg_file=vg_file,cut = 1e-5,log10_scale = TRUE)
violinplot
load_all()
# import gatherer files
path2 <- system.file("extdata", "virusgatherer.tsv", package = "Virusparies")
vg_file <- ImportVirusTable(path2)
# create a violinplot.
violinplot <- VgConLenViolin(vg_file=vg_file,cut = 1e-5,log10_scale = TRUE)
violinplot
load_all()
# import gatherer files
path2 <- system.file("extdata", "virusgatherer.tsv", package = "Virusparies")
vg_file <- ImportVirusTable(path2)
# create a violinplot.
violinplot <- VgConLenViolin(vg_file=vg_file,cut = 1e-5,log10_scale = TRUE)
violinplot
load_all()
# import gatherer files
path2 <- system.file("extdata", "virusgatherer.tsv", package = "Virusparies")
vg_file <- ImportVirusTable(path2)
# create a violinplot.
violinplot <- VgConLenViolin(vg_file=vg_file,cut = 1e-5,log10_scale = TRUE)
violinplot
load_all()
# import gatherer files
path2 <- system.file("extdata", "virusgatherer.tsv", package = "Virusparies")
vg_file <- ImportVirusTable(path2)
# create a violinplot.
violinplot <- VgConLenViolin(vg_file=vg_file,cut = 1e-5,log10_scale = TRUE)
violinplot
load_all()
# import gatherer files
path2 <- system.file("extdata", "virusgatherer.tsv", package = "Virusparies")
vg_file <- ImportVirusTable(path2)
# create a violinplot.
violinplot <- VgConLenViolin(vg_file=vg_file,cut = 1e-5,log10_scale = TRUE)
violinplot
load_all()
# import gatherer files
path2 <- system.file("extdata", "virusgatherer.tsv", package = "Virusparies")
vg_file <- ImportVirusTable(path2)
# create a violinplot.
violinplot <- VgConLenViolin(vg_file=vg_file,cut = 1e-5,log10_scale = TRUE)
violinplot
load_all()
# import gatherer files
path2 <- system.file("extdata", "virusgatherer.tsv", package = "Virusparies")
vg_file <- ImportVirusTable(path2)
# create a violinplot.
violinplot <- VgConLenViolin(vg_file=vg_file,cut = 1e-5,log10_scale = TRUE)
violinplot
load_all()
# import gatherer files
path2 <- system.file("extdata", "virusgatherer.tsv", package = "Virusparies")
vg_file <- ImportVirusTable(path2)
# create a violinplot.
violinplot <- VgConLenViolin(vg_file=vg_file,cut = 1e-5,log10_scale = TRUE)
violinplot
load_all()
# import gatherer files
path2 <- system.file("extdata", "virusgatherer.tsv", package = "Virusparies")
vg_file <- ImportVirusTable(path2)
# create a violinplot.
violinplot <- VgConLenViolin(vg_file=vg_file,cut = 1e-5,log10_scale = TRUE)
violinplot
load_all()
# import gatherer files
path2 <- system.file("extdata", "virusgatherer.tsv", package = "Virusparies")
vg_file <- ImportVirusTable(path2)
# create a violinplot.
violinplot <- VgConLenViolin(vg_file=vg_file,cut = 1e-5,log10_scale = TRUE)
violinplot
load_all()
# import gatherer files
path2 <- system.file("extdata", "virusgatherer.tsv", package = "Virusparies")
vg_file <- ImportVirusTable(path2)
# create a violinplot.
violinplot <- VgConLenViolin(vg_file=vg_file,cut = 1e-5,log10_scale = TRUE)
violinplot
load_all()
# import gatherer files
path2 <- system.file("extdata", "virusgatherer.tsv", package = "Virusparies")
vg_file <- ImportVirusTable(path2)
# create a violinplot.
violinplot <- VgConLenViolin(vg_file=vg_file,cut = 1e-5,log10_scale = TRUE)
violinplot
load_all()
# import gatherer files
path2 <- system.file("extdata", "virusgatherer.tsv", package = "Virusparies")
vg_file <- ImportVirusTable(path2)
# create a violinplot.
violinplot <- VgConLenViolin(vg_file=vg_file,cut = 1e-5,log10_scale = TRUE)
violinplot
load_all()
# import gatherer files
path2 <- system.file("extdata", "virusgatherer.tsv", package = "Virusparies")
vg_file <- ImportVirusTable(path2)
# create a violinplot.
violinplot <- VgConLenViolin(vg_file=vg_file,cut = 1e-5,log10_scale = TRUE)
violinplot
load_all()
# import gatherer files
path2 <- system.file("extdata", "virusgatherer.tsv", package = "Virusparies")
vg_file <- ImportVirusTable(path2)
# create a violinplot.
violinplot <- VgConLenViolin(vg_file=vg_file,cut = 1e-5,log10_scale = TRUE)
violinplot
load_all()
# import gatherer files
path2 <- system.file("extdata", "virusgatherer.tsv", package = "Virusparies")
vg_file <- ImportVirusTable(path2)
# create a violinplot.
violinplot <- VgConLenViolin(vg_file=vg_file,cut = 1e-5,log10_scale = TRUE)
violinplot
# import gatherer files
path2 <- system.file("extdata", "virusgatherer.tsv", package = "Virusparies")
vg_file <- ImportVirusTable(path2)
# create a violinplot.
violinplot <- VgConLenViolin(vg_file=vg_file,cut = 1e-5,log10_scale = TRUE)
violinplot
load_all()
# import gatherer files
path2 <- system.file("extdata", "virusgatherer.tsv", package = "Virusparies")
vg_file <- ImportVirusTable(path2)
# create a violinplot.
violinplot <- VgConLenViolin(vg_file=vg_file,cut = 1e-5,log10_scale = TRUE)
violinplot
load_all()
# import gatherer files
path2 <- system.file("extdata", "virusgatherer.tsv", package = "Virusparies")
vg_file <- ImportVirusTable(path2)
# create a violinplot.
violinplot <- VgConLenViolin(vg_file=vg_file,cut = 1e-5,log10_scale = TRUE)
violinplot
load_all()
# import gatherer files
path2 <- system.file("extdata", "virusgatherer.tsv", package = "Virusparies")
vg_file <- ImportVirusTable(path2)
# create a violinplot.
violinplot <- VgConLenViolin(vg_file=vg_file,cut = 1e-5,log10_scale = TRUE)
load_all()
# import gatherer files
path2 <- system.file("extdata", "virusgatherer.tsv", package = "Virusparies")
vg_file <- ImportVirusTable(path2)
# create a violinplot.
violinplot <- VgConLenViolin(vg_file=vg_file,cut = 1e-5,log10_scale = TRUE)
violinplot
load_all()
# import gatherer files
path2 <- system.file("extdata", "virusgatherer.tsv", package = "Virusparies")
vg_file <- ImportVirusTable(path2)
# create a violinplot.
violinplot <- VgConLenViolin(vg_file=vg_file,cut = 1e-5,log10_scale = TRUE)
violinplot
load_all()
# import gatherer files
path2 <- system.file("extdata", "virusgatherer.tsv", package = "Virusparies")
vg_file <- ImportVirusTable(path2)
# create a violinplot.
violinplot <- VgConLenViolin(vg_file=vg_file,cut = 1e-5,log10_scale = TRUE)
violinplot
load_all()
# import gatherer files
path2 <- system.file("extdata", "virusgatherer.tsv", package = "Virusparies")
vg_file <- ImportVirusTable(path2)
# create a violinplot.
violinplot <- VgConLenViolin(vg_file=vg_file,cut = 1e-5,log10_scale = TRUE)
violinplot
load_all()
# import gatherer files
path2 <- system.file("extdata", "virusgatherer.tsv", package = "Virusparies")
vg_file <- ImportVirusTable(path2)
# create a violinplot.
violinplot <- VgConLenViolin(vg_file=vg_file,cut = 1e-5,log10_scale = TRUE)
violinplot
load_all()
# import gatherer files
path2 <- system.file("extdata", "virusgatherer.tsv", package = "Virusparies")
vg_file <- ImportVirusTable(path2)
# create a violinplot.
violinplot <- VgConLenViolin(vg_file=vg_file,cut = 1e-5,log10_scale = TRUE)
violinplot
load_all()
# import gatherer files
path2 <- system.file("extdata", "virusgatherer.tsv", package = "Virusparies")
vg_file <- ImportVirusTable(path2)
# create a violinplot.
violinplot <- VgConLenViolin(vg_file=vg_file,cut = 1e-5,log10_scale = TRUE)
violinplot
# import gatherer files
path2 <- system.file("extdata", "virusgatherer.tsv", package = "Virusparies")
vg_file <- ImportVirusTable(path2)
# create a violinplot.
violinplot <- VgConLenViolin(vg_file=vg_file,cut = 1e-5,log10_scale = TRUE,jitter_point = 1)
violinplot
document()
check()
