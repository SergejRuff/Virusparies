deparse_args(groupby,taxa_rank,theme_choice,subtitle_face,legend_title,legend_position,legend_title_face)
non_string[1]
non_string <- deparse_args(groupby,taxa_rank,theme_choice,subtitle_face,legend_title,legend_position,legend_title_face)
non_string[1]
non_string[[1]]
groupby <- non_string[[1]]
groupby
non_string <- deparse_args(groupby,taxa_rank,theme_choice,subtitle_face,legend_title,legend_position,legend_title_face)
groupby <- non_string[[1]]
taxa_rank <- non_string[[2]]
theme_choice <- non_string[[3]]
subtitle_face <- non_string[[4]]
legend_title <- non_string[[5]]
legend_position <- non_string[[6]]
legend_title_face <- non_string[[7]]
legend_position
groupby = best_query
document()
load_all()
?VhgIdenFacetedScatterPlot
path <- system.file("extdata", "virushunter.tsv", package = "Virusparies")
file <- ImportVirusTable(path)
VhgIdenFacetedScatterPlot(file,cutoff = 1e-5,groupby = best_query)
VhgIdenFacetedScatterPlot(file,cutoff = 1e-5,groupby = ViralRefSeq_E)
VhgIdenFacetedScatterPlot(file,cutoff = 1e-5,groupby = ViralRefSeq_taxonomy)
VhgIdenFacetedScatterPlot(file,cutoff = 1e-5,groupby = ViralRefSeq_taxonomy)
deparse_args(groupby=ViralRefSeq_taxonomy,taxa_rank,theme_choice,subtitle_face,legend_title,legend_position,legend_title_face)
deparse_args(ViralRefSeq_taxonomy,taxa_rank,theme_choice,subtitle_face,legend_title,legend_position,legend_title_face)
groupby = ViralRefSeq_taxonomy
document()
check()
check()
document()
load_all()
?VhgIdentityScatterPlot
path <- system.file("extdata", "virushunter.tsv", package = "Virusparies")
file <- ImportVirusTable(path)
# Basic plot
plot <- VhgIdentityScatterPlot(file,cutoff = 1e-5)
plot(plot$plot)
document()
load_all()
path <- system.file("extdata", "virushunter.tsv", package = "Virusparies")
file <- ImportVirusTable(path)
# Basic plot
plot <- VhgIdentityScatterPlot(file,cutoff = 1e-5)
plot
check()
document()
check()
unique(file$best_query)
document()
check()
load_all()
?VhgIdentityScatterPlot
path <- system.file("extdata", "virushunter.tsv", package = "Virusparies")
file <- ImportVirusTable(path)
# Basic plot
plot <- VhgIdentityScatterPlot(file,cutoff = 1e-5)
plot(plot$plot)
install.packages("gghighlight")
use_package("gghighlight")
document()
document()
check()
load_all()
?VhgIdentityScatterPlot
path <- system.file("extdata", "virushunter.tsv", package = "Virusparies")
file <- ImportVirusTable(path)
unique(file$best_query)
VhgIdentityScatterPlot(file,cutoff = 1e-5,highlight_groups = "Genomo_Rep")
?gghighlight
load_all()
VhgIdentityScatterPlot(file,cutoff = 1e-5,highlight_groups = "Genomo_Rep")
load_all()
VhgIdentityScatterPlot(file,cutoff = 1e-5,highlight_groups = "Genomo_Rep")
load_all()
VhgIdentityScatterPlot(file,cutoff = 1e-5,highlight_groups = "Genomo_Rep")
load_all()
VhgIdentityScatterPlot(file,cutoff = 1e-5,highlight_groups = "Genomo_Rep")
load_all()
VhgIdentityScatterPlot(file,cutoff = 1e-5,highlight_groups = "Genomo_Rep")
load_all()
VhgIdentityScatterPlot(file,cutoff = 1e-5,highlight_groups = "Genomo_Rep")
load_all()
VhgIdentityScatterPlot(file,cutoff = 1e-5,highlight_groups = "Genomo_Rep")
load_all()
VhgIdentityScatterPlot(file,cutoff = 1e-5,highlight_groups = "Genomo_Rep")
load_all()
VhgIdentityScatterPlot(file,cutoff = 1e-5,highlight_groups = "Genomo_Rep")
load_all()
VhgIdentityScatterPlot(file,cutoff = 1e-5,highlight_groups = "Genomo_Rep")
load_all()
VhgIdentityScatterPlot(file,cutoff = 1e-5,highlight_groups = "Genomo_Rep")
VhgIdentityScatterPlot(file,cutoff = 1e-5,highlight_groups = "Genomo_Rep")
VhgIdentityScatterPlot(file,cutoff = 1e-5,highlight_groups = "Anello_ORF1core")
VhgIdentityScatterPlot(file,cutoff = 1e-5,highlight_groups = "Hepadna-Nackedna_TP","Gemini_Rep ")
VhgIdentityScatterPlot(file,cutoff = 1e-5,highlight_groups = c("Hepadna-Nackedna_TP","Gemini_Rep "))
load_all()
VhgIdentityScatterPlot(file,cutoff = 1e-5,highlight_groups = c("Hepadna-Nackedna_TP","Gemini_Rep "))
load_all()
VhgIdentityScatterPlot(file,cutoff = 1e-5,highlight_groups = c("Hepadna-Nackedna_TP","Gemini_Rep "))
load_all()
VhgIdentityScatterPlot(file,cutoff = 1e-5,highlight_groups = c("Hepadna-Nackedna_TP","Gemini_Rep "))
load_all()
VhgIdentityScatterPlot(file,cutoff = 1e-5,highlight_groups = c("Hepadna-Nackedna_TP","Gemini_Rep "))
load_all()
VhgIdentityScatterPlot(file,cutoff = 1e-5,highlight_groups = c("Hepadna-Nackedna_TP","Gemini_Rep "))
VhgIdentityScatterPlot(file,cutoff = 1e-5,highlight_groups = c("Hepadna-Nackedna_TP","Gemini_Rep"))
load_all()
VhgIdentityScatterPlot(file,cutoff = 1e-5,highlight_groups = c("Hepadna-Nackedna_TP","Gemini_Rep"))
load_all()
VhgIdentityScatterPlot(file,cutoff = 1e-5,highlight_groups = c("Hepadna-Nackedna_TP","Gemini_Rep"))
load_all()
VhgIdentityScatterPlot(file,cutoff = 1e-5,highlight_groups = c("Hepadna-Nackedna_TP","Gemini_Rep"))
load_all()
VhgIdentityScatterPlot(file,cutoff = 1e-5,highlight_groups = c("Hepadna-Nackedna_TP","Gemini_Rep"))
load_all()
VhgIdentityScatterPlot(file,cutoff = 1e-5,highlight_groups = c("Hepadna-Nackedna_TP","Gemini_Rep"))
load_all()
VhgIdentityScatterPlot(file,cutoff = 1e-5,highlight_groups = c("Hepadna-Nackedna_TP","Gemini_Rep"))
load_all()
VhgIdentityScatterPlot(file,cutoff = 1e-5,highlight_groups = c("Hepadna-Nackedna_TP","Gemini_Rep"))
load_all()
VhgIdentityScatterPlot(file,cutoff = 1e-5,highlight_groups = c("Hepadna-Nackedna_TP","Gemini_Rep"))
load_all()
VhgIdentityScatterPlot(file,cutoff = 1e-5,highlight_groups = c("Hepadna-Nackedna_TP","Gemini_Rep"))
load_all()
VhgIdentityScatterPlot(file,cutoff = 1e-5,highlight_groups = c("Hepadna-Nackedna_TP","Gemini_Rep"))
load_all()
VhgIdentityScatterPlot(file,cutoff = 1e-5,highlight_groups = c("Hepadna-Nackedna_TP","Gemini_Rep"))
VhgIdentityScatterPlot(file,cutoff = 1e-5)
VhgIdentityScatterPlot(file,cutoff = 1e-5,highlight_groups = c("Hepadna-Nackedna_TP","Gemini_Rep","Genomo_Rep"))
load_all()
VhgIdentityScatterPlot(file,cutoff = 1e-5,highlight_groups = c("Hepadna-Nackedna_TP","Gemini_Rep","Genomo_Rep"))
load_all()
VhgIdentityScatterPlot(file,cutoff = 1e-5,highlight_groups = c("Hepadna-Nackedna_TP","Gemini_Rep","Genomo_Rep"))
load_all()
VhgIdentityScatterPlot(file,cutoff = 1e-5,highlight_groups = c("Hepadna-Nackedna_TP","Gemini_Rep","Genomo_Rep"))
load_all()
VhgIdentityScatterPlot(file,cutoff = 1e-5,highlight_groups = c("Hepadna-Nackedna_TP","Gemini_Rep","Genomo_Rep"))
load_all()
VhgIdentityScatterPlot(file,cutoff = 1e-5,highlight_groups = c("Hepadna-Nackedna_TP","Gemini_Rep","Genomo_Rep"))
load_all()
VhgIdentityScatterPlot(file,cutoff = 1e-5,highlight_groups = c("Hepadna-Nackedna_TP","Gemini_Rep","Genomo_Rep"))
load_all()
load_all()
VhgIdentityScatterPlot(file,cutoff = 1e-5,highlight_groups = c("Hepadna-Nackedna_TP","Gemini_Rep","Genomo_Rep"))
load_all()
VhgIdentityScatterPlot(file,cutoff = 1e-5,highlight_groups = c("Hepadna-Nackedna_TP","Gemini_Rep","Genomo_Rep"))
load_all()
VhgIdentityScatterPlot(file,cutoff = 1e-5,highlight_groups = c("Hepadna-Nackedna_TP","Gemini_Rep","Genomo_Rep"))
load_all()
VhgIdentityScatterPlot(file,cutoff = 1e-5,highlight_groups = c("Hepadna-Nackedna_TP","Gemini_Rep","Genomo_Rep"))
load_all()
VhgIdentityScatterPlot(file,cutoff = 1e-5,highlight_groups = c("Hepadna-Nackedna_TP","Gemini_Rep","Genomo_Rep"))
?VhgIdentityScatterPlot
# import gatherer files
path2 <- system.file("extdata", "virusgatherer.tsv", package = "Virusparies")
vg_file <- ImportVirusTable(path2)
# vgplot: virusgatherer plot with ViralRefSeq_taxonomy as custom grouping
vgplot <- VhgIdentityScatterPlot(vg_file,groupby = "ViralRefSeq_taxonomy")
vgplot$plot
unique(vg_file$ViralRefSeq_taxonomy)
VhgIdentityScatterPlot(vg_file,groupby = "ViralRefSeq_taxonomy",highlight_groups = "Uroviricota")
VhgIdentityScatterPlot(vg_file,groupby = "ViralRefSeq_taxonomy",highlight_groups = "Hepadnaviridae")
VhgIdentityScatterPlot(vg_file,groupby = "ViralRefSeq_taxonomy",highlight_groups = "unclassified Uroviricota")
VhgIdentityScatterPlot(vg_file,groupby = "ViralRefSeq_taxonomy",
conlen_bubble_plot = TRUE,contiglen_breaks = 4,legend_position = "right",highlight_groups = "unclassified Uroviricota")
VhgIdentityScatterPlot(vg_file,groupby = "ViralRefSeq_taxonomy",
conlen_bubble_plot = TRUE,contiglen_breaks = 4,legend_position = "right",highlight_groups = "Hepadnaviridae")
VhgIdentityScatterPlot(vg_file,groupby = "ViralRefSeq_taxonomy",
conlen_bubble_plot = TRUE,contiglen_breaks = 4,legend_position = "right",highlight_groups = "Orthoherpesviridae")
VhgIdentityScatterPlot(vg_file,groupby = "ViralRefSeq_taxonomy",
conlen_bubble_plot = TRUE,contiglen_breaks = 4,legend_position = "right",highlight_groups = "unclassified Uroviricota")
load_all()
VhgIdentityScatterPlot(vg_file,groupby = "ViralRefSeq_taxonomy",
conlen_bubble_plot = TRUE,contiglen_breaks = 4,legend_position = "right",highlight_groups = "unclassified Uroviricota")
VhgIdentityScatterPlot(vg_file,groupby = "ViralRefSeq_taxonomy",
conlen_bubble_plot = TRUE,contiglen_breaks = 4,legend_position = "right",highlight_groups = "Orthoherpesviridae")
VhgIdentityScatterPlot(vg_file,groupby = "ViralRefSeq_taxonomy",
conlen_bubble_plot = TRUE,contiglen_breaks = 4,legend_position = "right",highlight_groups = "Hepadnaviridae")
load_all()
VhgIdentityScatterPlot(vg_file,groupby = "ViralRefSeq_taxonomy",
conlen_bubble_plot = TRUE,contiglen_breaks = 4,legend_position = "right",highlight_groups = "Hepadnaviridae")
load_all()
VhgIdentityScatterPlot(vg_file,groupby = "ViralRefSeq_taxonomy",
conlen_bubble_plot = TRUE,contiglen_breaks = 4,legend_position = "right",highlight_groups = "Hepadnaviridae")
load_all()
VhgIdentityScatterPlot(vg_file,groupby = "ViralRefSeq_taxonomy",
conlen_bubble_plot = TRUE,contiglen_breaks = 4,legend_position = "right",highlight_groups = "Hepadnaviridae")
load_all()
VhgIdentityScatterPlot(vg_file,groupby = "ViralRefSeq_taxonomy",
conlen_bubble_plot = TRUE,contiglen_breaks = 4,legend_position = "right",highlight_groups = "Hepadnaviridae")
load_all()
VhgIdentityScatterPlot(vg_file,groupby = "ViralRefSeq_taxonomy",
conlen_bubble_plot = TRUE,contiglen_breaks = 4,legend_position = "right",highlight_groups = "Hepadnaviridae")
load_all()
VhgIdentityScatterPlot(vg_file,groupby = "ViralRefSeq_taxonomy",
conlen_bubble_plot = TRUE,contiglen_breaks = 4,legend_position = "right",highlight_groups = "Hepadnaviridae")
load_all()
VhgIdentityScatterPlot(vg_file,groupby = "ViralRefSeq_taxonomy",
conlen_bubble_plot = TRUE,contiglen_breaks = 4,legend_position = "right",highlight_groups = "Hepadnaviridae")
load_all()
VhgIdentityScatterPlot(vg_file,groupby = "ViralRefSeq_taxonomy",
conlen_bubble_plot = TRUE,contiglen_breaks = 4,legend_position = "right",highlight_groups = "Hepadnaviridae")
load_all()
VhgIdentityScatterPlot(vg_file,groupby = "ViralRefSeq_taxonomy",
conlen_bubble_plot = TRUE,contiglen_breaks = 4,legend_position = "right",highlight_groups = "Hepadnaviridae")
load_all()
VhgIdentityScatterPlot(vg_file,groupby = "ViralRefSeq_taxonomy",
conlen_bubble_plot = TRUE,contiglen_breaks = 4,legend_position = "right",highlight_groups = "Hepadnaviridae")
load_all()
VhgIdentityScatterPlot(vg_file,groupby = "ViralRefSeq_taxonomy",
conlen_bubble_plot = TRUE,contiglen_breaks = 4,legend_position = "right",highlight_groups = "Hepadnaviridae")
load_all()
load_all()
VhgIdentityScatterPlot(vg_file,groupby = "ViralRefSeq_taxonomy",
conlen_bubble_plot = TRUE,contiglen_breaks = 4,legend_position = "right",highlight_groups = "Hepadnaviridae")
load_all()
VhgIdentityScatterPlot(vg_file,groupby = "ViralRefSeq_taxonomy",
conlen_bubble_plot = TRUE,contiglen_breaks = 4,legend_position = "right",highlight_groups = "Hepadnaviridae")
load_all()
VhgIdentityScatterPlot(vg_file,groupby = "ViralRefSeq_taxonomy",
conlen_bubble_plot = TRUE,contiglen_breaks = 4,legend_position = "right",highlight_groups = "Hepadnaviridae")
load_all()
VhgIdentityScatterPlot(vg_file,groupby = "ViralRefSeq_taxonomy",
conlen_bubble_plot = TRUE,contiglen_breaks = 4,legend_position = "right",highlight_groups = "Hepadnaviridae")
load_all()
VhgIdentityScatterPlot(vg_file,groupby = "ViralRefSeq_taxonomy",
conlen_bubble_plot = TRUE,contiglen_breaks = 4,legend_position = "right",highlight_groups = "Hepadnaviridae")
load_all()
VhgIdentityScatterPlot(vg_file,groupby = "ViralRefSeq_taxonomy",
conlen_bubble_plot = TRUE,contiglen_breaks = 4,legend_position = "right",highlight_groups = "Hepadnaviridae")
load_all()
VhgIdentityScatterPlot(vg_file,groupby = "ViralRefSeq_taxonomy",
conlen_bubble_plot = TRUE,contiglen_breaks = 4,legend_position = "right",highlight_groups = "Hepadnaviridae")
load_all()
VhgIdentityScatterPlot(vg_file,groupby = "ViralRefSeq_taxonomy",
conlen_bubble_plot = TRUE,contiglen_breaks = 4,legend_position = "right",highlight_groups = "Hepadnaviridae")
load_all()
VhgIdentityScatterPlot(vg_file,groupby = "ViralRefSeq_taxonomy",
conlen_bubble_plot = TRUE,contiglen_breaks = 4,legend_position = "right",highlight_groups = "Hepadnaviridae")
load_all()
VhgIdentityScatterPlot(vg_file,groupby = "ViralRefSeq_taxonomy",
conlen_bubble_plot = TRUE,contiglen_breaks = 4,legend_position = "right",highlight_groups = "Hepadnaviridae")
load_all()
VhgIdentityScatterPlot(vg_file,groupby = "ViralRefSeq_taxonomy",
conlen_bubble_plot = TRUE,contiglen_breaks = 4,legend_position = "right",highlight_groups = "Hepadnaviridae")
load_all()
VhgIdentityScatterPlot(vg_file,groupby = "ViralRefSeq_taxonomy",
conlen_bubble_plot = TRUE,contiglen_breaks = 4,legend_position = "right",highlight_groups = "Hepadnaviridae")
load_all()
VhgIdentityScatterPlot(vg_file,groupby = "ViralRefSeq_taxonomy",
conlen_bubble_plot = TRUE,contiglen_breaks = 4,legend_position = "right",highlight_groups = "Hepadnaviridae")
load_all()
VhgIdentityScatterPlot(vg_file,groupby = "ViralRefSeq_taxonomy",
conlen_bubble_plot = TRUE,contiglen_breaks = 4,legend_position = "right",highlight_groups = "Hepadnaviridae")
load_all()
VhgIdentityScatterPlot(vg_file,groupby = "ViralRefSeq_taxonomy",
conlen_bubble_plot = TRUE,contiglen_breaks = 4,legend_position = "right",highlight_groups = "Hepadnaviridae")
load_all()
VhgIdentityScatterPlot(vg_file,groupby = "ViralRefSeq_taxonomy",
conlen_bubble_plot = TRUE,contiglen_breaks = 4,legend_position = "right",highlight_groups = "Hepadnaviridae")
load_all()
VhgIdentityScatterPlot(vg_file,groupby = "ViralRefSeq_taxonomy",
conlen_bubble_plot = TRUE,contiglen_breaks = 4,legend_position = "right",highlight_groups = "Hepadnaviridae")
load_all()
VhgIdentityScatterPlot(vg_file,groupby = "ViralRefSeq_taxonomy",
conlen_bubble_plot = TRUE,contiglen_breaks = 4,legend_position = "right",highlight_groups = "Hepadnaviridae")
load_all()
VhgIdentityScatterPlot(vg_file,groupby = "ViralRefSeq_taxonomy",
conlen_bubble_plot = TRUE,contiglen_breaks = 4,legend_position = "right",highlight_groups = "Hepadnaviridae")
load_all()
VhgIdentityScatterPlot(vg_file,groupby = "ViralRefSeq_taxonomy",
conlen_bubble_plot = TRUE,contiglen_breaks = 4,legend_position = "right",highlight_groups = "Hepadnaviridae")
VhgIdentityScatterPlot(vg_file,groupby = "ViralRefSeq_taxonomy",
legend_position = "right",highlight_groups = "Hepadnaviridae")
VhgIdentityScatterPlot(vg_file,groupby = "ViralRefSeq_taxonomy",
legend_position = "right",highlight_groups = c("Hepadnaviridae","Allomimiviridae"))
load_all
load_all()
VhgIdentityScatterPlot(vg_file,groupby = "ViralRefSeq_taxonomy",
conlen_bubble_plot = TRUE,contiglen_breaks = 4,legend_position = "right",highlight_groups = "Hepadnaviridae")
VhgIdentityScatterPlot(vg_file,groupby = "ViralRefSeq_taxonomy",
legend_position = "right",highlight_groups = c("Hepadnaviridae","Allomimiviridae"))
load_all()
VhgIdentityScatterPlot(vg_file,groupby = "ViralRefSeq_taxonomy",
legend_position = "right",highlight_groups = c("Hepadnaviridae","Allomimiviridae"))
VhgIdentityScatterPlot(vg_file,groupby = "ViralRefSeq_taxonomy",
conlen_bubble_plot = TRUE,contiglen_breaks = 4,legend_position = "right",highlight_groups = "Hepadnaviridae")
VhgIdentityScatterPlot(vg_file,groupby = "ViralRefSeq_taxonomy",
conlen_bubble_plot = TRUE,contiglen_breaks = 4,legend_position = "right",highlight_groups = c("Hepadnaviridae","Phycodnaviridae"))
VhgIdentityScatterPlot(vg_file,groupby = "ViralRefSeq_taxonomy",
conlen_bubble_plot = TRUE,contiglen_breaks = 4,legend_position = "right",highlight_groups = c("Hepadnaviridae","Phycodnaviridae","Peduoviridae"))
document()
load_all()
VhgIdentityScatterPlot(vg_file,groupby = "ViralRefSeq_taxonomy",
conlen_bubble_plot = TRUE,contiglen_breaks = 4,legend_position = "right",highlight_groups = c("Hepadnaviridae","Phycodnaviridae","Peduoviridae"))
VhgIdentityScatterPlot(vg_file,groupby = "ViralRefSeq_taxonomy",
conlen_bubble_plot = TRUE,contiglen_breaks = 4,legend_position = "right",highlight_groups = c("Hepadnaviridae","Phycodnaviridae","Peduoviri"))
check()
document()
check()
document()
check()
use_package("scales")
document()
check()
document()
# Define the names for each element
taxa_names <- c(
"Subphylum",
"Class",
"Subclass",
"Order",
"Suborder",
"Family",
"Subfamily",
"Genus"
)
# Define the list with values
taxa_list <- list(
"viricotina",
"viricetes",
"viricetidae",
"virales",
"virineae",
"viridae",
"virinae",
"virus"
)
# Function to get the taxonomic rank based on suffix
get_taxonomic_rank <- function(virus_names) {
ranks <- character(length(virus_names))
for (i in seq_along(virus_names)) {
virus_name <- virus_names[i]
if (grepl("unclassified \\+ phylum", virus_name, ignore.case = TRUE)) {
ranks[i] <- "Unclassified + Phylum"
} else if (grepl("unclassified", virus_name, ignore.case = TRUE)) {
ranks[i] <- "Unclassified"
} else {
matched <- FALSE
for (j in seq_along(taxa_list)) {
if (grepl(taxa_list[[j]], virus_name, ignore.case = TRUE)) {
ranks[i] <- taxa_names[j]
matched <- TRUE
break
}
}
if (!matched) {
ranks[i] <- "Unknown"
}
}
}
return(ranks)
}
# Example usage
virus_names <- c("Coronavirus", "Adenovirales", "Picornaviridae", "Herpesvirinae", "unclassified + phylum", "unclassified")
ranks <- get_taxonomic_rank(virus_names)
print(ranks)
# Define the names for each element
taxa_names <- c(
"Subphylum",
"Class",
"Subclass",
"Order",
"Suborder",
"Family",
"Subfamily",
"Genus"
)
# Define the list with values
taxa_list <- c(
"viricotina",
"viricetes",
"viricetidae",
"virales",
"virineae",
"viridae",
"virinae",
"virus"
)
# Function to get the most common taxonomic rank based on suffix
get_most_common_taxonomic_rank <- function(virus_names) {
ranks <- c()
for (virus_name in virus_names) {
if (!grepl("unclassified \\+ phylum|unclassified", virus_name, ignore.case = TRUE)) {
for (j in seq_along(taxa_list)) {
if (grepl(taxa_list[j], virus_name, ignore.case = TRUE)) {
ranks <- c(ranks, taxa_names[j])
break
}
}
}
}
if (length(ranks) == 0) {
return("No valid taxonomic rank found")
}
most_common_rank <- names(sort(table(ranks), decreasing = TRUE))[1]
return(most_common_rank)
}
# Example usage
virus_names <- c("Coronavirus", "Adenovirales", "Picornaviridae", "Herpesvirinae", "unclassified + phylum", "unclassified", "Flavivirus")
most_common_rank <- get_most_common_taxonomic_rank(virus_names)
print(most_common_rank)
virus_names <- c("Coronavirus", "Adenovirus", "Coronavirus", "Herpesvirus", "unclassified + phylum", "unclassified", "Flavivirus")
most_common_rank <- get_most_common_taxonomic_rank(virus_names)
print(most_common_rank)
virus_names <- c( "Adenovirus", "unclassified + phylum", "unclassified", )
virus_names <- c( "Adenovirus", "unclassified + phylum", "unclassified" )
most_common_rank <- get_most_common_taxonomic_rank(virus_names)
print(most_common_rank)
virus_names <- c( "Adenovirus", "Adenovirales","virales", "unclassified + phylum", "unclassified" )
most_common_rank <- get_most_common_taxonomic_rank(virus_names)
print(most_common_rank)
virus_names <- c( "unclassified + phylum", "unclassified" )
most_common_rank <- get_most_common_taxonomic_rank(virus_names)
print(most_common_rank)
library(Virusparies)
?VhgBoxplot
path <- system.file("extdata", "virushunter.tsv", package = "Virusparies")
file <- ImportVirusTable(path)
?VhgPreprocessTaxa
path <- system.file("extdata", "virushunter.tsv", package = "Virusparies")
vh_file <- ImportVirusTable(path)
vh_file_filtered <- VhgPreprocessTaxa(vh_file,"Family")
get_most_common_taxonomic_rank(vh_file_filtered)
get_most_common_taxonomic_rank(vh_file_filtered$ViralRefSeq_taxonomy)
vh_file_filtered <- VhgPreprocessTaxa(vh_file,"Order")
get_most_common_taxonomic_rank(vh_file_filtered$ViralRefSeq_taxonomy)
vh_file[["ViralRefSeq_taxonomy"]]
# Function to get the most common taxonomic rank based on suffix
get_most_common_taxonomic_rank <- function(virus_names) {
ranks <- c()
for (virus_name in virus_names) {
if (!grepl("unclassified \\+ phylum|unclassified", virus_name, ignore.case = TRUE)) {
for (j in seq_along(taxa_list)) {
if (grepl(taxa_list[j], virus_name, ignore.case = TRUE)) {
ranks <- c(ranks, taxa_names[j])
break
}
}
}
}
if (length(ranks) == 0) {
return("unclassified")
}
most_common_rank <- names(sort(table(ranks), decreasing = TRUE))[1]
return(most_common_rank)
}
get_most_common_taxonomic_rank(c("unclassified + phylum", "unclassified"))
unique(vh_file$ViralRefSeq_taxonomy)
unique(vh_file_filtered$ViralRefSeq_taxonomy)
# Function to get the most common taxonomic rank based on suffix
get_most_common_taxonomic_rank <- function(virus_names) {
ranks <- c()
for (virus_name in virus_names) {
if (!grepl("unclassified", virus_name, ignore.case = TRUE)) {
for (j in seq_along(taxa_list)) {
if (grepl(taxa_list[j], virus_name, ignore.case = TRUE)) {
ranks <- c(ranks, taxa_names[j])
break
}
}
}
}
if (length(ranks) == 0) {
return("unclassified")
}
most_common_rank <- names(sort(table(ranks), decreasing = TRUE))[1]
return(most_common_rank)
}
# Example data frame
file <- data.frame(
ViralRefSeq_taxonomy = c("unclassified + phylum Firmicutes", "unclassified", "unclassified univiricota", "Coronavirus", "Adenovirales", "Picornaviridae"),
stringsAsFactors = FALSE
)
# Check the groupby condition
groupby <- "ViralRefSeq_taxonomy"
# Get the most common taxonomic rank
taxa_rank <- get_most_common_taxonomic_rank(file[[groupby]])
taxa_rank
# Example data frame
file <- data.frame(
ViralRefSeq_taxonomy = c("unclassified + phylum Firmicutes", "unclassified", "unclassified univiricota"),
stringsAsFactors = FALSE
)
# Check the groupby condition
groupby <- "ViralRefSeq_taxonomy"
# Get the most common taxonomic rank
taxa_rank <- get_most_common_taxonomic_rank(file[[groupby]])
taxa_rank
if (taxa_rank == "unclassified") {
# Create the Phylum column based on ViralRefSeq_taxonomy
file$Phylum <- ifelse(grepl("unclassified", file[[groupby]], ignore.case = TRUE),
ifelse(grepl("unclassified\\s+(\\S+)", file[[groupby]], ignore.case = TRUE),
gsub("unclassified\\s+", "", file[[groupby]]),
"unclassified"),
NA)
}
print(file)
document()
document()
document()
check()
document()
check()
check()
load_all()
install()
document()
